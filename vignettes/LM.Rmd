---
title: "Linear models"
author: "Alexandre Courtiol"
date: "`r Sys.Date()`"
output:
  ioslides_presentation:
    widescreen: true
    smaller: true
vignette: >
  %\VignetteIndexEntry{2.0 Linear models}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
---
```{r setup, include=FALSE}
library(LM2GLMM)
```

# Introduction

## What is a linear model?

### What is a statistical model?

###***A statistical model represents, often in considerably idealized form, the data-generating process.*** [(wikipedia)](https://en.wikipedia.org/wiki/Statistical_model)
<br>

### What is linear?

###***The data-generating process is assumed to be a linear function: it is constructed from a set of terms by multiplying each term by a constant and adding the results .***

## Mathematical notation of LM: simple notation

<center><font size="5"> $y_i = \beta_0 + \beta_1 \times x_{1,i} + \beta_2 \times x_{2,i} + \dots + \beta_{p} \times x_{p,i} + \epsilon_i$ </font></center>

<br>

* $y_i$ = the observations to explain / explanatory variable / dependent variable
* $x_{j,i}$ = the constants derived from the predictors / explanatory variables / independent variables
* $\beta_j$ = the regression coefficients / model parameters
* $\epsilon_i$ = the errors $\rightarrow$ **we assume: <font size="5"> $\epsilon_i \sim \mathcal{N}(0, \sigma^2)$</font>**


## Mathematical notation of LM: matrix notation

<center><font size = 8> $Y = X \beta + \epsilon$ </font></center>

$$
\begin{bmatrix} y_1 \\ y_2 \\ y_3 \\ \dots \\ y_n \end{bmatrix} =
\begin{bmatrix}
1 & x_{1,1} & x_{2,1} & \dots & x_{p,1} \\
1 & x_{1,2} & x_{2,2} & \dots & x_{p,2} \\
1 & x_{1,3} & x_{2,3} & \dots & x_{p,3} \\
\dots & \dots & \dots & \dots & \dots \\
1 & x_{1,n} & x_{2,n} & \dots & x_{p,n}
\end{bmatrix}
\begin{bmatrix}
\beta_0 \\ \beta_1 \\ \beta_2 \\ \beta_3 \\ \dots \\ \beta_n
\end{bmatrix} +
\begin{bmatrix}
\epsilon_1 \\ \epsilon_2 \\ \epsilon_3 \\ \dots \\ \epsilon_n
\end{bmatrix}
$$

<br>

* $Y$ = a vector of observations
* $X$ = an matrix called the model (or design) matrix
* $\beta$ = a vector of model parameters
* $\epsilon$ = a vector of errors $\rightarrow$ **we assume:  <font size="5"> $\epsilon \sim \mathcal{N}(0, \sigma^2 I)$</font>**

## The Alien dataset

### Imagine an ideal (unrealistic) situation

We know that the process generating the height of aliens can be
approximated by the following linear model:

* $\texttt{height}_i = 50 + 1.5 \times \texttt{humans_eaten}_{i} + \epsilon_i$
* $\epsilon_i \sim \mathcal{N}(0, \sigma^2 = 25)$

<br>

We can thus generate the data corresponding to 6 aliens that have eaten
between 1 and 6 humans.

```{r alien data}
set.seed(123L)
Alien <- data.frame(humans_eaten = sample(1:6))
Alien$error <- rnorm(n = 6, mean = 0, sd = sqrt(25))
Alien$size <- 50 + 1.5*Alien$humans_eaten + Alien$error
```

## The Alien dataset

```{r alien data show}
Alien
```
<div class="columns-2">

### Simple notation
* $y_1 = 50 + 1.5 \times `r Alien$humans_eaten[1]` + `r Alien$error[1]`$
* $y_2 = 50 + 1.5 \times `r Alien$humans_eaten[2]` + `r Alien$error[2]`$
* $y_3 = 50 + 1.5 \times `r Alien$humans_eaten[3]` + `r Alien$error[3]`$
* $y_4 = 50 + 1.5 \times `r Alien$humans_eaten[4]` + `r Alien$error[4]`$
* $y_5 = 50 + 1.5 \times `r Alien$humans_eaten[5]` + `r Alien$error[5]`$
* $y_6 = 50 + 1.5 \times `r Alien$humans_eaten[6]` + `r Alien$error[6]`$

### Matrix notation
$$
Y = \begin{bmatrix}
1 & `r Alien$humans_eaten[1]` \\
1 & `r Alien$humans_eaten[2]` \\
1 & `r Alien$humans_eaten[3]` \\
1 & `r Alien$humans_eaten[4]` \\
1 & `r Alien$humans_eaten[5]` \\
1 & `r Alien$humans_eaten[6]`
\end{bmatrix}
\begin{bmatrix}
50 \\
1.5
\end{bmatrix}
+
\begin{bmatrix}
`r Alien$error[1]`\\
`r Alien$error[2]`\\
`r Alien$error[3]`\\
`r Alien$error[4]`\\
`r Alien$error[5]`\\
`r Alien$error[6]`
\end{bmatrix}
$$

</div>


## How to get the model (or design) matrix?

```{r pred matrix}
model.matrix(object = ~ humans_eaten, data = Alien)
```

<br>

### This should always work, even if the model gets much more complex!


## Matrix operations in R

```{r matrix multiplication}
X <- model.matrix(object = ~ humans_eaten, data = Alien)
B <- matrix(c(50, 1.5), ncol = 1)
X %*% B
```
```{r matrix sum}
E <- as.matrix(Alien$error)
X %*% B + E
```



# Table of content

## The Linear Model: LM

2.1 [Fitting Linear Models](./fitting_LM.html)
