---
title: "LM: fitting procedures"
subtitle: "exercises"
author: "Alexandre Courtiol"
date: "`r Sys.Date()`"
output:
  ioslides_presentation:
    widescreen: true
    smaller: true
vignette: >
  %\VignetteIndexEntry{2.1 z-------------------------------------------------------------exercises}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
---

```{r setup, include=FALSE}
library(LM2GLMM)
knitr::opts_chunk$set(cache = FALSE)
options(width = 110)
set.seed(1L)
```

## Fitting a LM by REML

In LM, REstricted Maximum Likelihood (aka REML) fits correspond to fits for which the (log-)likelihood is computed based on a data generating process that is gaussian (as in ML) and that uses as variance for the distribution the error variance estimate rather than the population residual variance.

Adapt the code shown in the course to compute the log-likelihood of the REML fit with formula `size ~ humans_eaten` using the following data:

```{r}
set.seed(123)
Alien <- simulate_Aliens()
```


Compare the results with the outcome of the following call:

```{r, message=FALSE}
library(spaMM)
fit_spaMM_REML    <- fitme(size ~ humans_eaten, data = Alien, method = "REML")
```


##

<div align="right">
[Back to main menu](./Title.html#2)
</div>
